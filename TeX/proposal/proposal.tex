\documentclass[11pt]{report}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[english]{babel}
\usepackage[labelfont=bf]{caption}

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}
\usepackage{fancyhdr} % Headers and footers
\pagestyle{fancy} % All pages have headers and footers
\fancyhead{} % Blank out the default header
\fancyfoot{} % Blank out the default footer
\fancyhead[C]{Myocardial Necrosis $\bullet$ BIO4134 $\bullet$ Shifman \& Cole} % Custom header text
\fancyfoot[RO,LE]{Page \thepage} % Custom footer text

\graphicspath{ {/Users/yvesmarcel/repos/modeling_final/TeX/images/} } % hard coded mine, sorry about that


% create a new env for the dedication box - just for you Aaron
\newenvironment{dedication}
  {\clearpage           % we want a new page
   \thispagestyle{empty}% no header and footer
   \vspace*{\stretch{1}}% some space at the top 
   \itshape             % the text is in italics
   \raggedleft          % flush to the right margin
  }
  {\par % end the paragraph
   \vspace{\stretch{3}} % space at bottom is three times that at the top
   \clearpage           % finish off the page
  }



\title{\vspace{-15mm}\fontsize{24pt}{10pt}\selectfont\textbf{Extending the Fitzhugh Nagumo Excitable Tissue
Model to Myocardial Necrosis}} % Article title

\author{
\large
\textsc{Aaron R. Shifman, Christopher B. Cole}\thanks{BIO4134 Final Project}\\[2mm] % Your name
\normalsize University of Ottawa \\ % Your institution
\vspace{-5mm}
}
\date{}

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Insert title

\thispagestyle{fancy} % All pages have headers and footers

%\tableoffigures

\begin{dedication}
``In general, throughout the work, what is new is not good; and what is good is not new'' - \textbf{Reverend Martin Sherlock}, 1781 
\end{dedication}

\begin{abstract}

Neuroscience frequently relies on robust mathematical models to simulate and investigate trends in neuromechanics and signal propagation. We propose an examination of the Fitzhugh-Nagumo model, and additionally propose a modified extension of this model to account for necrosis of cardiac cells. We use this model to investigate case studies in cardiac necrosis and examine the effect of necrosis on a one dimensional cardiac model. 
\end{abstract}


\newpage

\tableofcontents

\newpage

\listoffigures

\newpage

\chapter{Examination of the Fitzhugh Nagumo Model}

The modelling of neurons and associated action potentials started in the early 1900s with the ``integrate and fire'' model.$^1$ In 1952, Hodgkin and Huxley created a biologically relevant 4 dimensional system of equations to describe neuron dynamics at a point.$^2$ While very interesting to biologists, mathematicians found the model too difficult to systematically study. In 1961 Richard Fitzhugh created a 2D caricature of the Hodgkin Huxley model (activation and recovery) using a modified Van-der-Pol oscillator.$^3$ This model has been both well studied and well characterized. Additionally, it has found many uses in cardiac models due to its simplicity and similarity in shape to a cardiac action potential. 

The Hodgkin Huxley equations described how neuronal membrane voltage changed over time, given a large number of parameters. 

\begin{align}
C_m \frac{dV}{dt} &= I_m = I_{Na} + I_{K} + I_l \\
I_x &= \bar{G_x}p_{open}(V_m-E_x); x\in\{Na,K,l\}\\
p_{open_{K}} &= n^4\\
p_{open_{Na}} &= m^3h\\
p_{open_{l}} &\equiv 1\\
\frac{dx}{dt} &= \alpha_x(V)(1-x)-\beta_x(V)x; x\in{m,n,h}\\
\end{align}

This model is impossible to solve analytically, and quite difficult to explore numerically due to both the high dimensionality of the system and the large number of parameters. In studying hyperplanes through the 4D phase space, Nagumo noticed that all planes of activation and recovery variables had a similar shape, so he tried modeling neuronal activity as a modified Van-der-Pol oscillator (Bonheffer-Van-der-Pol oscillator). This model, while not looking like stereotyped action potentials, has several features of the full hodgkin huxley model such as activation hysteresis and spike blocking. Despite not looking like a neuronal action potential, it closely resembles cardiac action potentials and have since been adapted as one of the de-facto models for cardiac simulations. 


\section{Model Rationale and Variables}

The system presents in the following, non-dimensionalized form. This is not the original Bonheffer-Van-der-Pol model, however it is topologically equivalent and much easier to analyse. All models which follow are non-dimensionalized. 

$$ \begin{aligned} \frac{dV}{dt} &= V(\alpha+V)(1-V) -W + z \\
\frac{dW}{dt} &= \beta V-cW \end{aligned} $$

In this model $V$ - in general - represents activation, and in an excitable tissue context represents voltage. and $W$ - in general represents recovery, and has no realistic interpretation in a biological context, it would be the sum of all positive (with regard to the cell) currents. There are four parameters in the model, $\alpha$, $\beta$, $c$, and $z$. Of the four parameters, we have significant interest in $z$, as it will determine the bifurcation of the model. Neurologically, $z$ represents the direct current (DC) offset from experimentally injected current of the neuron under study. In our extension to this model, we will replace $z$ with a gap junctional current from coupled cells (see section \ref{sub:coupled_oscillators}). The additional parameters $\alpha$, $\beta$, and $c$ represent ``rate - like'' constants which determine oscillator traits such as amplitude, frequency, duty cycle, and excitability.


\section{Purpose of Model and Examination}

This model, a simplification of the original Hodgkin Huxley model, intends to model spiking cardiac neurons. Tuning the individual parameters can adapt the model to fit various states and conditions which may be investigated by researchers. Various combinations of parameters can also model neuronal behaviors such as bursting and chattering. These models can be put together to form multi-dimensional models of neuron trends. The state of the neuron relies on the $z$ parameter. 
In this project, we plan to evaluate the stability of system at rest and with regards to the bifurcation parameter $z$. We plan to evaluate how the system responds and bifurcates with regards to this parameter, and interpret these stabilities biologically. 


\begin{figure}[!ht]
  \caption{Time series of $V$ and $W$ following the Fitzhugh Nagumo model. $\alpha = 0.01, \beta = 0.5,c = 0.1,z = 0.5$}
  \centering
    \includegraphics[width=0.75\textwidth]{model}
\end{figure}

Initially, we present a naive time series of the model. We notice that with the set of parameters presented in Eugene Izhikevich 2006, the system oscillates in a stable limit cycle. These parameters, utilized throughout the rest of this report unless otherwise noted, are as follows:

$$ \begin{aligned} \alpha &= 0.01 \\ \beta &= 0.5 \\ c &= 0.1 \\ z &= 0.5 \end{aligned} $$

Using the above parameters, we plot the system on the interval $0 < t \leq 200$ with arbitrary units for time. Note that the system is solved through an adaptive solver \textbf{odeint} in Python 2. 


\section{Model Classification} % (fold)
\label{sub:model_classification}

We classify the system according to the criterion established by Haefner et. al $^{3}$ and find the model is:

\begin{enumerate}
	\item \textbf{Mechanistic} rather than phenomenological. FN models neural dyanmics as a function of individual processes acting on the neuron, including terms analagous to the DC offset, excitation, and relaxation. In this way, the model details the process of neural excitation and is process oriented.
	\item \textbf{Dynamic} rather than static. The system models excitation and relaxation as a function of time, and is thus a dynamic model.
	\item \textbf{Continuous} rather than discrete. The model uses time on an arbitrary scale as a continuous variable, instead of taking predefined ``steps''. In this way, the system uses time continuously. 
	\item \textbf{Spatially homogenous} rather than spatially heterogeneous. The model contains no explicit description of space, and is thus homogeneous. 
	\item \textbf{Deterministic} rather than stochastic. All terms in the model are entirely predictable given initial conditions and no events based on chance occur. Thus the model is deterministic. 
\end{enumerate}

% subsection dimensionalization (end)
\section{Stability Analysis} % (fold)
\label{sub:stability_analysis}

Taking our model such that:

$$\begin{aligned}
f(x) &= \dot{V} = V(\alpha + V)(1-V) -W +z \\
g(x) &= \dot{W} = \beta V -cW
\end{aligned}
$$

We compute the Jacobian Matrix $\vec{J}$:


$$
\vec{J} = \begin{bmatrix}
    \frac{\partial f}{\partial{V}} & \frac{\partial f}{\partial{W}} \\
    \frac{\partial g}{\partial{V}} & \frac{\partial g}{\partial{W}} \\
\end{bmatrix} = 
\begin{bmatrix}
    −2\alpha V+\alpha+(2 - 3V)V & -1 \\
    \beta & -c \\
\end{bmatrix}
$$


Taking $\alpha,\beta,c$ equal to 0.01,0.5,0.1 respectively,
$$
\begin{bmatrix}
    −0.02V+(2−3V)V+0.01 & -1 \\
    0.5 & -0.1 \\    
\end{bmatrix}
$$

This implies that eigenvalues $\lambda_{1,2}$ may be complex or not. 

Eigenvalues 1 and 2 as follows

$$ \lambda_{1,2} \approx \begin{bmatrix} 0.5(-3V^2 - 1.98V + \sqrt{ 9V^4 + 11.88 V^3 + 3.2604 V^2 - 0.4356 V - 1.9879 } - 0.09) \\ 0.5(-3V^2 - 1.98V - \sqrt{ 9V^4 + 11.88 V^3 + 3.2604 V^2 - 0.4356 V - 1.9879 } - 0.09) \end{bmatrix} $$

with corresponding eigenvectors

$$ v_{1,2} \approx \begin{bmatrix} 0.11 + 1.98V - 3V^2 + \sqrt{ 9V^4 + 11.88 V^3 + 3.2604 V^2 - 0.4356 V - 1.9879} & 1 \\ 0.11 + 1.98V - 3V^2 - \sqrt{ 9V^4 + 11.88 V^3 + 3.2604 V^2 - 0.4356 V - 1.9879} & 1 \end{bmatrix} $$

We plot the eigevalues to describe their dynamics. 

\begin{figure}[!ht]
  \caption{Eigenvalues as a function of the steady state $V^*$ for $z$.  $\alpha = 0.01, \beta = 0.5,c = 0.1,z \in [0,5]$ }
  \centering
    \includegraphics[width=0.75\textwidth]{eig}
\end{figure}

Note that the vertical axis of the above plot corresponds to the value of the eigenvalue, while the lower horizontal axis denotes the value of the steady state $V^*$ for $z \in [0,5]$ while the upper horizontal axis corresponds to the $z$ value itself.

There is an observable bifurcation when the real component of the eigenvalue passes from negative to positive just above $V^*(z) = 0$, and when the real component of $\lambda$ passes from positive to negative, at just below $V^*(z) = 0.6$. To confirm these values we plot a low resolution bifurcation:


\begin{figure}[!ht]
  \caption{Low resolution bifurcation diagram of the system. Stable limit of $V$ plotted on the vertical axis while $z$ is depicted on the horizontal. $\alpha = 0.01, \beta = 0.5,c = 0.1,z \in [0,5]$ }
  \centering
    \includegraphics[width=0.75\textwidth]{lbifur}
\end{figure}


and subsequently confirm this with a tigher view of the left bifurcation point.

\begin{figure}[!ht]
  \caption{High resolution bifurcation diagram of the system. Stable limit of $V$ plotted on the vertical axis while $z$ is depicted on the horizontal. $\alpha = 0.01, \beta = 0.5,c = 0.1,z \in [0,5]$ }
  \centering
    \includegraphics[width=0.75\textwidth]{hbifur}
\end{figure}


This appears to be an example of a Hopf bifurcation point at both of these instances. There is initially a fixed point which is stable, corresponding to no oscillation as well as a pair of complex conjugate eigenvalues. As $z$ increases and reaches the first bifurcation, the fixed point loses stability and the stable limit cycle forms. That is, until $z$ reaches the seconf bifurcation point and the limit cycle collapses back to the single stable fixed point as the real component of the eigenvalue once again becomes negative. We can visualize this stable limit cycle by plotting the phase plane of the system with a stable value of $z = 0.5$.

\begin{figure}[!ht]
  \caption{Phase plane of the FN system. $\alpha = 0.01, \beta = 0.5,c = 0.1,z \in [0,5]$ }
  \centering
    \includegraphics[width=0.75\textwidth]{phase-plane}
\end{figure}

This clearly displays the system oscilating for the appropriate value of $z$. In the following section, we take advantage of this property and modify the $z$ term to incorporate both coupled oscilators and the disease etiology of myocardial necrosis. 




\section{Coupled Oscillators} % (fold)
\label{sub:coupled_oscillators}

The previously described model is useful for observing the dynamics of a single cardiac neuron, however occasionally researchers wish to incorporate several connected neuros in the same system. 

Here we couple neurons, first two, then $n$, in a modified *synfire* chain. In this network, current is expressed through gap junctions and can only travel in one direction. 


\includegraphics{2couple}
\includegraphics{ncouple}



% subsection coupled_oscillators (end)

%end original model, begin extension

\chapter{Modelling Myocardial Necrosis} 


\section{Translational Perspective} %how the model relates to disease

The heart serves a vital role in many organisms. The timely and regular delivery of oxygenated blood is essential to survival, and thus any decrease from optimum efficiency is of consequence. Investigations into potential mechanistic explainations and modeling of this degradation are highly interesting in the context of both accute and chronic cardiac disease.

In particular, myocardial necrosis can be caused by accute oxygen deprivation of myocardial tissues, commonly experienced during a heart attack. Other potential etiologies stem from depriving this tissue of the blood it requires; dangerous increase in physical stresses, coronary artery disease, and accute hemerage all have the potential to play into cardiac necrosis, perhaps in tandem. 

In our investigation into the decreasing efficiency of a heart-like system, we will model several scenarios that may be of consequence to sufferers of cardiac necrosis. In particular, we study two cases. The first, static necrosis, closely resembles a short term or acute stress on myocardial tissue, be it a myocardial infarction or trauma. We will investigate how the distribution of necrosis affects the system as a whole through the FN model. Through a translation lens, this equates to the decrease in efficiency as a consequence of various kinds of trauma. The second case will be a slowly increasing level of necrosis. This more closely resembles coronary artery disease, which has the potential to starve the tissues of oxygen for many years, slowly leading to health deficits in older age. We study the approximate timeframe for simulated tachycardia, or dangerously low heart beat. 

Throughout the investigation, we refer to a cell's necrosis burden as analagous to a protein build up, though this simply refers to the degree of degredation for that specific cell.

Our proposed extension to the FN model plans to shed light on the geneisis, progression, and finally the consequences of myocardial necrosis. 

\section{Necrosis Propagation}

As part of the normal cell cycle, programmed cell death (apoptosis) exists and it serves several purposes. In most cases, it is both irreversible and adaptive (beneficial) for the organism. However in some cases, apoptosis can occur accidentally in which case an irreversible destruction of the cell will occur. In our model, we assume that necrosis is a function of an underlying accumulation of pro-apoptotic proteins, potentially introduced as a byproduct of disease. As such, necrosis is a continuous state of each cell. For cell $i$ of $n$, define pro-necrotic burden as $\nu_i$, with total burden of the system equal to $\frac{\sum^n_{i=1} \nu_i}{n}=\frac{1}{n} \sum^n_{i=1} \nu_i$. Note that $\nu_{1}, ..., \nu_{n} \in [0,1]$ and is a monotonically increasing function with respect to time. 

Starting with the Fitzhugh Nagumo model equivalent
\begin{align}
\frac{dV}{dt} &= V(\alpha +V)(1-V) -W +z\\
\frac{dW}{dt} &= \beta V - cW
\end{align}
We connect connect oscillators with a gap junctional current ($I_g = G_g(\Delta V)$). For a population of $n$ oscillators $\Omega$, with members $\omega_i; i\in \textbf{N}; 1\leq i\leq n$. If $\omega_i$ is connected to $x; x\subset\Omega$, then the gap junctional current to $\omega_i$ is $\sum_{x} G_{x,i}(V_i-V_x)$

In the case of 2 oscillators ($A$ and $B$)

\begin{align}
\frac{dV_A}{dt} &= V(\alpha +V_A)(1-V_A) -W_A + G_g(V_A-V_B) + z_A\\
\frac{dV_B}{dt} &= V(\alpha +V_B)(1-V_B) -W_B + G_g(V_B-V_A) +z_B\\
\frac{dW_A}{dt} &= \beta V_A - cW_A\\
\frac{dW_B}{dt} &= \beta V_B - cW_B
\end{align}

\section{Diseased States}
For the coupled oscillators representing cardiac myocytes (eq. 3-6), as the cells die through an apoptotic pathway, a fraction of their gap junctions $\nu \in [0,1]$ will be destroyed, through cell decay.

In order to model disease, each myocyte will have a corresponding $\nu$ term, such that

\begin{align}
\frac{dV_A}{dt} &= V(\alpha +V_A)(1-V_A) -W_A + (1-\nu_A) G_g(V_A-V_B) + z_A\\
\frac{dV_B}{dt} &= V(\alpha +V_B)(1-V_B) -W_B + (1-\nu_B) G_g(V_B-V_A) +z_B
\end{align}
With increasing $\nu$, the cell becomes less responsive to its coupled partners

\section{Static Disease Burden} % (fold)
\label{sub:static_disease_burden}

\begin{enumerate}
	\item Does distance (Distance between $N_i$ and $N_j= j -i$) influence $D$
	\item Is $D$ decreased more by a few heavily burdened cells, or by a large number of moderately burdened cells
	\item At what point does the build up of pro-necrotic proteins become a health issue (health being defined such that $T_t \geq kT_n; k\in[0,1]$)
\end{enumerate}

\section{Dynamic Disease Burden} % (fold)
\label{sub:dynamic_disease_burden}

In order to extend this model to model cardiac necrosis, we use the previously described coupling and add $\nu_i$ as an ordinary differential equation describing the dampening on neuron $i$ ($N_i$). In the present simplication, $\nu_i$ will depend only on time. Define $\nu_{0i}$ as the *a priori* necrotic burden of $N_i$. 

We wish to construct a model of $\nu_{i}$ evolution where, eventually, the disease will destroy the cell. Thus, we wish to have 1 (complete dampening) as a stable steady state. Additionally, we require that any concentration of $\nu_{0i}$ will eventually lead to cell death. We chose the model

$$ \frac{d \nu_i}{dt} = \dot{\nu} = \nu_i (1 - \nu_i) $$

\includegraphics{dynamic}
\includegraphics{2dyn}
\includegraphics{ndyn}
% subsection dynamic_disease_burden (end)


% subsection static_disease_burden (end)
\section{Web App} % (fold)
\label{sub:web_app}


\includegraphics[scale = 0.4]{R}
% subsection web_app (end)
\newpage

\chapter{References} % (fold)
\label{sec:references}

\begin{enumerate}
	\item Abbott, L. . Lapicque’s introduction of the integrate-and-fire model neuron \(1907\). Brain Res. Bull. 50, 303–304 \(1999\).
	\item Hodgkin, A. L., Huxley, A. F. A quantitative description of membrane current and its application to conduction and excitation in nerve. J. Physiol. 117, 500–44 \(1952\).
	\item Haefner, J. W. Models of Systems. Modeling Biological Systems: Principles and Applications \(Springer, 2005\). doi:10.1007/0-387-25012-3\_1
\end{enumerate}


% section references (end)

\end{document}





